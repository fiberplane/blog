---
import '@fontsource/geist-sans/400.css';
import '@fontsource/geist-sans/500.css';
import '@fontsource/geist-sans/600.css';
import '@fontsource/geist-sans/700.css';
import '@fontsource/geist-mono/400.css';

interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" href="/favicon-light.svg" media="(prefers-color-scheme: light)" />
    <link rel="icon" href="/favicon-dark.svg" media="(prefers-color-scheme: dark)" />
    <meta name="generator" content={Astro.generator} />
    <title>{title} | Fiberplane Blog</title>
  </head>
  <body>
    <header class="site-header">
      <nav class="nav-container">
        <a href="/" class="logo">
          <img src="/logo.svg" alt="Fiberplane" />
        </a>
        <div class="nav-links">
          <a href="/" class="nav-link">Blog</a>
          <a href="https://docs.fiberplane.com" class="nav-link">Docs</a>
          <div class="social-links">
            <a href="https://github.com/fiberplane" aria-label="GitHub" class="social-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
              </svg>
            </a>
            <a href="https://discord.com/invite/cqdY6SpfVR" aria-label="Discord" class="social-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/>
              </svg>
            </a>
            <a href="https://x.com/fiberplane" aria-label="X" class="social-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
          </div>
          <div class="nav-separator"></div>
          <div class="theme-toggle">
            <button class="theme-button" data-theme="auto" aria-label="Auto theme">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="9" y1="3" x2="9" y2="21"></line>
              </svg>
            </button>
            <button class="theme-button" data-theme="light" aria-label="Light theme">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
              </svg>
            </button>
            <button class="theme-button" data-theme="dark" aria-label="Dark theme">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
              </svg>
            </button>
          </div>
        </div>
      </nav>
    </header>
    <main>
      <slot />
    </main>
    <footer class="site-footer">
      <p>&copy; {new Date().getFullYear()} Fiberplane. All rights reserved.</p>
    </footer>
  </body>
</html>

<script>
  // Theme toggle functionality
  function getThemePreference(): string {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme') || 'auto';
    }
    return 'auto';
  }

  function setTheme(theme: string) {
    if (theme === 'auto') {
      document.documentElement.removeAttribute('data-theme');
    } else {
      document.documentElement.setAttribute('data-theme', theme);
    }
    localStorage.setItem('theme', theme);

    // Update active button
    document.querySelectorAll('.theme-button').forEach((button) => {
      button.classList.remove('active');
    });
    const activeButton = document.querySelector(`[data-theme="${theme}"]`);
    if (activeButton) {
      activeButton.classList.add('active');
    }
  }

  // Initialize theme on page load
  document.addEventListener('DOMContentLoaded', () => {
    const theme = getThemePreference();
    setTheme(theme);

    // Add click handlers
    document.querySelectorAll('.theme-button').forEach((button) => {
      button.addEventListener('click', () => {
        const theme = button.getAttribute('data-theme');
        if (theme) {
          setTheme(theme);
        }
      });
    });
  });

  // Handle page navigation (for view transitions or SPA-like behavior)
  document.addEventListener('astro:page-load', () => {
    const theme = getThemePreference();
    setTheme(theme);
  });
</script>

<style is:global>
  :root {
    /* Light mode colors */
    --color-text: hsl(0, 0%, 35%);
    --color-text-secondary: hsl(0, 0%, 55%);
    --color-heading: hsl(0, 0%, 10%);
    --color-bg: hsl(0, 0%, 100%);
    --color-bg-secondary: hsl(0, 0%, 99%);
    --color-border: hsl(0, 0%, 90%);
    --color-accent: hsl(212, 100%, 50%);
    --color-accent-dark: hsl(212, 100%, 45%);
    --color-accent-light: hsl(212, 100%, 96%);

    /* Code block colors - light theme */
    --color-code-bg: hsl(0, 0%, 96%);
    --color-code-border: hsl(0, 0%, 88%);
  }

  /* Dark mode - auto (system preference) */
  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) {
      /* Dark mode colors */
      --color-text: hsl(0, 0%, 82%);
      --color-text-secondary: hsl(0, 0%, 65%);
      --color-heading: hsl(0, 0%, 98%);
      --color-bg: hsl(0, 0%, 5%);
      --color-bg-secondary: hsl(0, 0%, 8%);
      --color-border: hsl(0, 0%, 20%);
      --color-accent: hsl(212, 100%, 60%);
      --color-accent-dark: hsl(212, 100%, 70%);
      --color-accent-light: hsl(212, 100%, 15%);

      /* Code block colors - dark theme */
      --color-code-bg: hsl(0, 0%, 10%);
      --color-code-border: hsl(0, 0%, 25%);
    }
  }

  /* Dark mode - manual */
  :root[data-theme="dark"] {
    /* Dark mode colors */
    --color-text: hsl(0, 0%, 82%);
    --color-text-secondary: hsl(0, 0%, 65%);
    --color-heading: hsl(0, 0%, 98%);
    --color-bg: hsl(0, 0%, 5%);
    --color-bg-secondary: hsl(0, 0%, 8%);
    --color-border: hsl(0, 0%, 20%);
    --color-accent: hsl(212, 100%, 60%);
    --color-accent-dark: hsl(212, 100%, 70%);
    --color-accent-light: hsl(212, 100%, 15%);

    /* Code block colors - dark theme */
    --color-code-bg: hsl(0, 0%, 10%);
    --color-code-border: hsl(0, 0%, 25%);
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html {
    font-family: 'Geist Sans', system-ui, sans-serif;
    background-color: var(--color-bg);
    color: var(--color-text);
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  body {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* Smooth transitions for theme changes */
  *,
  *::before,
  *::after {
    transition-property: background-color, border-color, color, fill, stroke;
    transition-duration: 0.3s;
    transition-timing-function: ease;
  }

  main {
    flex: 1;
  }

  /* Header styles */
  .site-header {
    border-bottom: 1px solid var(--color-border);
    background-color: var(--color-bg);
  }

  .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .logo {
    display: inline-block;
  }

  .nav-links {
    display: flex;
    gap: 2rem;
    align-items: center;
  }

  .nav-link {
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.9375rem;
    font-weight: 500;
    transition: color 0.2s ease;
  }

  .nav-link:hover {
    color: var(--color-heading);
  }

  .social-links {
    display: flex;
    gap: 0.75rem;
    align-items: center;
  }

  .social-link {
    color: var(--color-text-secondary);
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: color 0.2s ease;
    padding: 0.25rem;
  }

  .social-link:hover {
    color: var(--color-heading);
  }

  .social-link svg {
    display: block;
  }

  .nav-separator {
    width: 1px;
    height: 24px;
    background-color: var(--color-border);
    margin: 0 -0.75rem;
  }

  .theme-toggle {
    display: flex;
    gap: 0;
    background-color: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 9999px;
    padding: 0.25rem;
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }

  .theme-button {
    background: none;
    border: none;
    padding: 0.5rem;
    cursor: pointer;
    color: var(--color-text-secondary);
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    width: 32px;
    height: 32px;
  }

  .theme-button:hover {
    color: var(--color-heading);
  }

  .theme-button.active {
    background-color: var(--color-bg);
    color: var(--color-heading);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .logo img {
    height: auto;
    width: 100px;
    transition: filter 0.3s ease;
  }

  /* Invert logo in light mode */
  .logo img {
    filter: invert(1);
  }

  /* Don't invert in dark mode (auto with dark system preference) */
  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) .logo img {
      filter: invert(0);
    }
  }

  /* Don't invert in manual dark mode */
  :root[data-theme="dark"] .logo img {
    filter: invert(0);
  }

  /* Syntax highlighting - use CSS variables for theme switching */
  .astro-code {
    background-color: var(--color-code-bg) !important;
  }

  /* Switch to dark theme colors in dark mode (auto with dark system preference) */
  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) .astro-code {
      background-color: var(--shiki-dark-bg) !important;
    }
    :root:not([data-theme="light"]) .astro-code span {
      color: var(--shiki-dark) !important;
    }
  }

  /* Switch to dark theme colors in manual dark mode */
  :root[data-theme="dark"] .astro-code {
    background-color: var(--shiki-dark-bg) !important;
  }
  :root[data-theme="dark"] .astro-code span {
    color: var(--shiki-dark) !important;
  }

  /* Footer styles */
  .site-footer {
    border-top: 1px solid var(--color-border);
    padding: 2rem;
    text-align: center;
    color: var(--color-text-secondary);
    font-size: 0.875rem;
  }
</style>
